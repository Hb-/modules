<div class="xar-mod-head"><span class="xar-mod-title"><xar:mlstring>Workflow Administration</xar:mlstring></span></div>
<div class="xar-mod-body"><h2>#xarML('Monitor processes')#
<!-- the help link info </xar:comment>
  
      <xar:if condition="$feature_help eq 'y'">
<a href="http://tikiwiki.org/tiki-index.php?page=GalaxiaMonitorProcesses" target="tikihelp" class="tikihelp" title="#xarML('Tikiwiki.org help')#: #xarML('Galaxia Monitor Processes')#">
<img border='0' src='modules/workflow/lib/Galaxia/img/icons/help.gif' alt='help' /></xar:if>
                        <xar:if condition="$feature_help eq 'y'"></a></xar:if>


</h2><br />
<div style="margin: auto;">
<xar:comment> beginning of next bit </xar:comment>






<xar:template file="monitor_bar" type="module"/>
<h3>#xarML('List of processes')# (#$cant#)</h3>

<form action="&xar-modurl-workflow-admin-monitor_processes;" method="post">
<input type="hidden" name="offset" value="#$offset#" />
<input type="hidden" name="sort_mode" value="#$sort_mode#" />
<table>
<tr>
<td>
	<small>#xarML('process')#</small>
</td>
<td>
	<small>#xarML('active')#</small>
</td>
<td>
	<small>#xarML('valid')#</small>
</td>
<td>
	<small>#xarML('description')#</small>
</td>
<td>
	&nbsp;
</td>	
</tr>

<tr>
<td>
	<select name="filter_process">
<xar:if condition="'' eq $filter_process">
	<option selected="selected" value="">#xarML('All')#</option>
<xar:else/>
	<option value="">#xarML('All')#</option>
</xar:if>
	<xar:foreach in="$all_procs" key="$ix">
<xar:if condition="$all_procs[$ix]['pId'] eq $filter_process">
	<option selected="selected" value="#$all_procs[$ix]['pId']#">#$all_procs[$ix]['name']# #$all_procs[$ix]['version']#</option>
<xar:else/>
	<option value="#$all_procs[$ix]['pId']#">#$all_procs[$ix]['name']# #$all_procs[$ix]['version']#</option>
</xar:if>
	</xar:foreach>
	</select>
</td>
<td>
	<select name="filter_active">
<xar:if condition="'' eq $filter_active">
	<option selected="selected" value="">#xarML('All')#</option>
<xar:else/>
	<option value="">#xarML('All')#</option>
</xar:if>
<xar:if condition="'y' eq $filter_active">
	<option value="y" selected="selected">#xarML('Active')#</option>
<xar:else/>
	<option value="y">#xarML('Active')#</option>
</xar:if>
<xar:if condition="'n' eq $filter_active">
	<option value="n" selected="selected">#xarML('Inactive')#</option>
<xar:else/>
	<option value="n">#xarML('Inactive')#</option>
</xar:if>
	</select>
</td>
<td>
	<select name="filter_valid">
<xar:if condition="'' eq $filter_valid">
	<option selected="selected" value="">#xarML('All')#</option>
<xar:else/>
	<option value="">#xarML('All')#</option>
</xar:if>
<xar:if condition="'y' eq $filter_valid">
	<option selected="selected" value="y">#xarML('Valid')#</option>
<xar:else/>
	<option value="y">#xarML('Valid')#</option>
</xar:if>
<xar:if condition="'n' eq $filter_valid">
	<option selected="selected" value="n">#xarML('Invalid')#</option>
<xar:else/>
	<option value="n">#xarML('Invalid')#</option>
</xar:if>
	</select>
</td>
<td>
	<input size="8" type="text" name="find" value="#$find#" />
</td>
<td>	
	<input type="submit" name="filter" value="#xarML('filter')#" />
</td>
</tr>
</table>	
</form>

<form action="&xar-modurl-workflow-admin-monitor_processes;" method="post">
<input type="hidden" name="offset" value="#$offset#" />
<input type="hidden" name="find" value="#$find#" />
<input type="hidden" name="where" value="#$where#" />
<input type="hidden" name="sort_mode" value="#$sort_mode#" />
<table class="normal">
<xar:if condition="!empty($items) and count($items) gt 0">
<tr>
<td  class="heading" ><a class="tableheading" href="#xarServerGetCurrentURL(array("sort_mode" => 'name_asc'))#">#xarML('Process')#</a></td>
<td  class="heading" >#xarML('Activities')#</td>
<td  class="heading" ><a class="tableheading" href="#xarServerGetCurrentURL(array("sort_mode" => 'isActive_asc'))#">#xarML('Active')#</a></td>
<td  class="heading" ><a class="tableheading" href="#xarServerGetCurrentURL(array("sort_mode" => 'isValid_asc'))#">#xarML('Valid')#</a></td>
<td  class="heading" >#xarML('Instances')#<br/>
<td  class="heading" >#xarML('Duration of completed processes - min/avg/max')#<br/>
</td>
</tr>
<xar:foreach in="$items" key="$ix">
<tr>
	<td>
	  <a class="link" href="&xar-modurl-workflow-admin-processes;&amp;pid=#$items[$ix]['pId']#">#$items[$ix]['name']# #$items[$ix]['version']#</a>
	</td>
	<td style="text-align:right;">
		<a href="&xar-modurl-workflow-admin-monitor_activities;&amp;filter_process=#$items[$ix]['pId']#" class="link">#$items[$ix]['activities']#</a>
	</td>


	  

	<td style="text-align:center;">
	  <xar:if condition="$items[$ix]['isActive'] eq 'y'">
	  <img src='modules/workflow/lib/Galaxia/img/icons/refresh2.gif' alt=' (#xarML('active')#) ' title='#xarML('active process')#' />
	  <xar:else/>
	  &nbsp;
	  </xar:if>
	</td>
	<td style="text-align:center;">
	  <xar:if condition="$items[$ix]['isValid'] eq 'n'">
	  <img src='modules/workflow/lib/Galaxia/img/icons/red_dot.gif' alt=' (#xarML('invalid')#) ' title='#xarML('invalid process')#' />
	  <xar:else/>
	  <img src='modules/workflow/lib/Galaxia/img/icons/green_dot.gif' alt=' (#xarML('valid')#) ' title='#xarML('valid process')#' />
	  </xar:if>

	</td>
	
	<td style="text-align:right;">
		<table >
		<tr>
		 <td style="text-align:right;"><a style="color:green;" href="&xar-modurl-workflow-admin-monitor_instances;&amp;filter_process=#$items[$ix]['pId']#&amp;filter_status=active">#$items[$ix]['active_instances']#</a></td>
		 <td style="text-align:right;"><a style="color:black;" href="&xar-modurl-workflow-admin-monitor_instances;&amp;filter_process=#$items[$ix]['pId']#&amp;filter_status=completed">#$items[$ix]['completed_instances']#</a></td>
		 <td style="text-align:right;"><a style="color:grey;" href="&xar-modurl-workflow-admin-monitor_instances;&amp;filter_process=#$items[$ix]['pId']#&amp;filter_status=aborted">#$items[$ix]['aborted_instances']#</a></td>
		 <td style="text-align:right;"><a style="color:red;" href="&xar-modurl-workflow-admin-monitor_instances;&amp;filter_process=#$items[$ix]['pId']#&amp;filter_status=exception">#$items[$ix]['exception_instances']#</a></td>
		</tr>
		</table>
	</td>

	<td style="text-align:left;">
	<xar:if condition="!empty($items[$ix]['duration'])">
	<xar:if condition="!empty($items[$ix]['timescale']['min'])"><img src="modules/workflow/xarimages/bluepixel.gif" width="#$items[$ix]['timescale']['min']#" height="10" border="0" alt="minimum" title="minimum = #$items[$ix]['duration']['min']#" /></xar:if>
	<xar:if condition="!empty($items[$ix]['timescale']['avg'])"><img src="modules/workflow/xarimages/greenpixel.gif" width="#$items[$ix]['timescale']['avg']#" height="10" border="0" alt="average" title="average = #$items[$ix]['duration']['avg']#" /></xar:if>
	<xar:if condition="!empty($items[$ix]['timescale']['max'])"><img src="modules/workflow/xarimages/redpixel.gif" width="#$items[$ix]['timescale']['max']#" height="10" border="0" alt="maximum" title="maximum = #$items[$ix]['duration']['max']#" /></xar:if>
	#$items[$ix]['duration']['avg']#
	</xar:if>
	</td>
</tr>
</xar:foreach>
<xar:else/>
<tr>
	<td colspan="6">
	#xarML('No processes found')#
	</td>
</tr>	
</xar:if>
</table>
</form>

<div class="mini">
<div align="center">
<xar:if condition="$prev_offset ge 0">
[<a class="prevnext" href="#xarServerGetCurrentURL(array("offset" => $prev_offset))#">#xarML('prev')#</a>]&nbsp;
</xar:if>
#xarML('Page')#: #$actual_page#/#$cant_pages#
<xar:if condition="$next_offset ge 0">
&nbsp;[<a class="prevnext" href="#xarServerGetCurrentURL(array("offset" => $next_offset))#">#xarML('next')#</a>]
</xar:if>
<xar:if condition="$direct_pagination eq 'y'">
<br/>
#$pager#
</xar:if>
</div>
</div> 

<xar:template file="monitor_stats" type="module"/>
<p><i>Based on the <a href="http://tikiwiki.org/tiki-index.php?page=GalaxiaWorkflow">Galaxia Workflow Engine</a></i></p>
</div>
</div>
