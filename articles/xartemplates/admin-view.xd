<div class="xar-mod-head">
    <span class="xar-mod-title">
        <xar:mlstring>
            Articles Administration
        </xar:mlstring>
    </span>
</div>
<div class="xar-mod-body">
    <h2>
        <xar:mlstring>
            View Articles
        </xar:mlstring>
    </h2>
    <div>
<!-- Roles is a core module.  We should be able to count on that being there, although I believe that it should go in the base module -->
        <xar:template file="navtabs" type="module" />
        <xar:template file="navtabs-status" type="module" />
        <xar:categories-navigation layout="trails" showchildren="1" module="articles" type="admin" itemtype="$ptid" catid="$catid" />
        <xar:if condition="$showstatus">
<xar:base-include-javascript module="base" filename="checkall.js" />
            <form method="post" name="viewarticles" id="viewarticles" action="#xarModURL('articles','admin','updatestatus')#">
                <div>
                    <input type="hidden" name="ptid" id="ptid" value="#$ptid#" />
                    <input type="hidden" name="catid" id="catid" value="#$catid#" />
                    <input type="hidden" name="authid" id="authid" value="#xarSecGenAuthKey()#" />
                </xar:if>
                <xar:if condition="$shownewlink">
                    <h3>
                        <a href="#$newurl#">
                            <xar:mlstring>
                                New Article
                            </xar:mlstring>
                        </a>
                    </h3>
                </xar:if>
                <table width="100%" border="0" cellpadding="2" cellspacing="1" class="xar-accent">
                    <tr>
                        <th>
                            #$labels['title']#
                        </th>
                        <xar:if condition="$showdate">
                            <th>
                                #$labels['pubdate']#
                            </th>
                        </xar:if>
                        <xar:if condition="$showstatus">
                            <th colspan="2">
                                #$labels['status']#
                            </th>
                        </xar:if>
                        <th>
                            <xar:mlstring>
                                Options
                            </xar:mlstring>
                        </th>
                    </tr>
                    <xar:foreach in="$items" value="$item">
                        <tr>
                            <td class="xar-norm">
                                #$item['title']#
                            </td>
                            <xar:if condition="$showdate">
                                <td class="xar-norm">
                                    #xarLocaleFormatDate('%x %X %z',$item['pubdate'])#
                                </td>
                            </xar:if>
                            <xar:if condition="$showstatus">
                                <td class="xar-norm">
                                    <label for="aids[#$item['aid']#]">
                                        #$item['status']#
                                    </label>
                                </td>
                                <td class="xar-norm">
                                    <xar:if condition="!empty($item['editurl'])">
                                        <input type="checkbox" name="aids[#$item['aid']#]" id="aids[#$item['aid']#]" value="1" #$item['selected']# />
                                    </xar:if>
                                </td>
                            </xar:if>
                            <td style="text-align: center;" class="xar-norm">
                                <xar:if condition="empty($item['viewurl'])">
                                    #$item['viewtitle']# 
                                    <xar:else />
                                    <a href="#$item['viewurl']#">
                                        #$item['viewtitle']#
                                    </a>
                                </xar:if>
                                | 
                                <xar:if condition="empty($item['editurl'])">
                                    #$item['edittitle']# 
                                    <xar:else />
                                    <a href="#$item['editurl']#">
                                        #$item['edittitle']#
                                    </a>
                                </xar:if>
                                | 
                                <xar:if condition="empty($item['deleteurl'])">
                                    #$item['deletetitle']# 
                                    <xar:else />
                                    <a href="#$item['deleteurl']#">
                                        #$item['deletetitle']#
                                    </a>
                                </xar:if>
                            </td>
                        </tr>
                    </xar:foreach>
                </table>
                <xar:if condition="!empty($showstatus) and count($items) gt 0">
                    <p>
                        <label for="status">
                            <xar:mlstring>
                                Change checked article status to
                            </xar:mlstring>
                            :</label>&nbsp; 
                        <select name="status" id="status">
                        <xar:if condition="xarSecurityCheck('DeleteArticles',0,'Article',$ptid.':All:All:All')">
                            <option value="-1">
                                <xar:mlstring>
                                    [Delete All]
                                </xar:mlstring>
                            </option>
                        </xar:if>
                            <option value="0">
                                <xar:mlstring>
                                    Submitted
                                </xar:mlstring>
                            </option>
                            <option value="1">
                                <xar:mlstring>
                                    Rejected
                                </xar:mlstring>
                            </option>
                            <option value="2" selected="selected">
                                <xar:mlstring>
                                    Approved
                                </xar:mlstring>
                            </option>
                            <xar:if condition="xarModGetVar('articles','defaultpubtype') eq $ptid or xarModGetVar('articles','defaultpubtype') eq ''">
                                <option value="3">
                                    <xar:mlstring>
                                        Front Page
                                    </xar:mlstring>
                                </option>
                            </xar:if>
                        </select>
                        <input type="submit" value="#$changestatuslabel#" />
<script language="JavaScript" type="text/javascript">
	document.write("[ <a href=\"javascript:xar_base_checkall(document.forms['viewarticles'],true)\"><xar:mlstring>Check All</xar:mlstring></a> | ");
	document.write("<a href=\"javascript:xar_base_checkall(document.forms['viewarticles'],false)\"><xar:mlstring>Uncheck All</xar:mlstring></a> ]");
</script>
                    </p>
                </xar:if>
            </div>
        </form>
        #$pager# 
    </div>
</div>
