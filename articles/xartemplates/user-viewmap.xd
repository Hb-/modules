<xar:if condition="count($cattree) gt 0">
    <h2><xar:mlstring>Article Map by Category</xar:mlstring></h2>
    <br />
    #$dump#
    <br />
    <xar:foreach in="$cattree" value="$childcats">
        <xar:foreach in="$childcats" value="$cat">
            #$cat['beforetags']#
            <xar:if condition="!empty($cat['link'])">
                <a href="#$cat['link']#">#$cat['name']#</a>
                <xar:else />
                    #$cat['name']#
            </xar:if>
            <xar:if condition="!empty($cat['count'])">
                (#$cat['count']#)
            </xar:if>
            #$cat['aftertags']#
        </xar:foreach>
    </xar:foreach>

    <br />
    <a href="#xarModURL('articles','user','viewmap',array('by' => 'pub'))#"><xar:mlstring>Article Map by Publication Type</xar:mlstring></a>
    <br />

<xar:else />
    <h2><xar:mlstring>Article Map by Publication Type</xar:mlstring></h2>
    <br />
    #$dump#
    <br />
    <table border="1" cellpadding="4">
    <tr>
        <th>
            <xar:mlstring>Publication</xar:mlstring>
        </th>
        <th>
            <xar:mlstring>Relevant Categories</xar:mlstring> 
        </th>
    </tr>
    <xar:foreach in="$publinks" value="$pubtype">
    <tr>
        <td valign="top">
        <xar:if condition="empty($pubtype['publink'])">
            #$pubtype['pubtitle']#
            <xar:else />
                <a href="#$pubtype['publink']#">#$pubtype['pubtitle']#</a>
        </xar:if>
        <xar:if condition="!empty($pubtype['pubcount'])">
            (#$pubtype['pubcount']#)
        </xar:if>
        </td>
        <td>
        <xar:foreach in="$pubtype['cats']" value="$childcats">
            <xar:foreach in="$childcats" value="$cat">
                #$cat['beforetags']#
                <xar:if condition="!empty($cat['link'])">
                    <a href="#$cat['link']#">#$cat['name']#</a>
                    <xar:else />
                        #$cat['name']#
                </xar:if>
                <xar:if condition="!empty($cat['count'])">
                    (#$cat['count']#)
                </xar:if>
                #$cat['aftertags']#
            </xar:foreach>
        </xar:foreach>
        </td>
    </tr>
    </xar:foreach>
    </table>

    <br />
    <a href="#xarModURL('articles','user','viewmap',array('by' => 'cat'))#"><xar:mlstring>Article Map by Category</xar:mlstring></a>
    <br />

</xar:if>

<br />
<table border="0" width="95%"><tr><td align="left">
    <a href="#$viewlink#">#$viewlabel#</a>
</td><td align="right">
    <a href="#$archivelink#">#$archivelabel#</a>
</td></tr></table>
    
