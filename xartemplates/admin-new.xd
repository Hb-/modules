<xar:comment> License: GPL http://www.gnu.org/copyleft/gpl.html </xar:comment>

<xar:template type="module" file="admin-header" />
<div class="xar-mod-body">
    <h2><xar:mlstring>New Publication</xar:mlstring></h2>

    <form method="post" action="&xar-modurl-ebulletin-admin-create;">
        <fieldset>
            <legend><xar:mlstring>General Options</xar:mlstring></legend>

            <div class="xar-form-input-wrapper">
                <label for="name"  class="xar-form-label" title="#xarML('Name')#">
                    <xar:mlstring>Name:</xar:mlstring>
                </label>
                <input type="text" name="name" id="name" value="#$name#" maxlength="255" class="xar-form-textlong" />
                <span class="xar-error">*</span>
                <xar:if condition="!empty($invalid['name'])">
                    <div class="xar-error">
                        <xar:mlstring>ERROR! Name cannot be blank.</xar:mlstring>
                    </div>
                </xar:if>
            </div>

            <div class="xar-form-input-wrapper">
                <label for="description"  class="xar-form-label" title="#xarML('Description')#">
                    <xar:mlstring>Description:</xar:mlstring>
                </label>
                <input type="text" name="description" id="description" value="#$description#" size="60" maxlength="255" />
            </div>

            <div class="xar-form-input-wrapper">
                <label for="public"  class="xar-form-label" title="#xarML('Make publicly viewable')#">
                    <xar:mlstring>Make Public:</xar:mlstring>
                </label>
                <xar:if condition="$public">
                    <input type="checkbox" name="public" id="public" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="public" id="public" value="1" />
                </xar:if>
            </div>

            <div class="xar-form-input-wrapper">
                <label for="scheduler"  class="xar-form-label" title="#xarML('Scheduler options')#">
                    <xar:mlstring>Schedule automatic execution:</xar:mlstring>
                </label>
                    <input type="radio" name="scheduler" id="sch-none" value="0" checked="checked" />
                <label for="sch-none"  class="xar-form-label" title="#xarML('None')#">
                    <xar:mlstring>None</xar:mlstring>
                </label>
                    <input type="radio" name="scheduler" id="sch-issue" value="1" />
                <label for="sch-issue"  class="xar-form-label" title="#xarML('Issue only')#">
                    <xar:mlstring>Issue</xar:mlstring>
                </label>
                    <input type="radio" name="scheduler" id="sch-publish" value="2" />
                <label for="sch-publish"  class="xar-form-label" title="#xarML('Publish only')#">
                    <xar:mlstring>Publish</xar:mlstring>
                </label>
                    <input type="radio" name="scheduler" id="sch-isspub" value="3" />
                <label for="sch-isspub"  class="xar-form-label" title="#xarML('Issue and publish')#">
                    <xar:mlstring>Issue and publish</xar:mlstring>
                </label>
            </div>

        </fieldset>
        <fieldset>
            <legend><xar:mlstring>Mail Headers</xar:mlstring></legend>

            <div class="xar-form-input-wrapper">
                <label for="fromname"  class="xar-form-label" title="#xarML('From name')#">
                    <xar:mlstring>From:</xar:mlstring>
                </label>
                <xar:mlstring>Name:</xar:mlstring> <input type="text" name="fromname" id="fromname" value="#$fromname#" maxlength="255" class="xar-form-textmedium" /> &nbsp;
                <xar:mlstring>Email:</xar:mlstring> <input type="text" name="from" id="from" value="#$from#" maxlength="255" class="xar-form-textmedium" />
                <span class="xar-error">*</span>
                <xar:if condition="!empty($invalid['from'])">
                    <div class="xar-error">
                        <xar:mlstring>ERROR! From email cannot be blank.</xar:mlstring>
                    </div>
                </xar:if>
            </div>

            <div class="xar-form-input-wrapper">
                <label for="replytoname"  class="xar-form-label" title="#xarML('Reply-To name')#">
                    <xar:mlstring>Reply-To:</xar:mlstring>
                </label>
                <xar:mlstring>Name:</xar:mlstring> <input type="text" name="replytoname" id="replytoname" value="#$replytoname#" maxlength="255" class="xar-form-textmedium" /> &nbsp;
                <xar:mlstring>Email:</xar:mlstring> <input type="text" name="replyto" id="replyto" value="#$replyto#" maxlength="255" class="xar-form-textmedium" />
            </div>

            <div class="xar-form-input-wrapper">
                <label for="subject"  class="xar-form-label" title="#xarML('Subject')#">
                    <xar:mlstring>Subject:</xar:mlstring>
                </label>
                <input type="text" name="subject" id="subject" value="#$subject#" maxlength="255" size="60"  />
                <span class="xar-error">*</span>
                <xar:if condition="!empty($invalid['subject'])">
                    <div class="xar-error">
                        <xar:mlstring>ERROR! Subject cannot be blank.</xar:mlstring>
                    </div>
                </xar:if>
            </div>

        </fieldset>
        <fieldset>
            <legend><xar:mlstring>Mail Body</xar:mlstring></legend>

            <div class="xar-form-input-wrapper">
                <label for="template" class="xar-form-label" title="#xarML('Template')#">
                    <xar:mlstring>Template:</xar:mlstring>
                </label>
                <input type="text" name="template" id="template" value="#$template#" maxlength="255" class="xar-form-textmedium" />
                <span class="xar-error">*</span>
                <xar:if condition="!empty($invalid['template'])">
                    <div class="xar-error">
                        <xar:mlstring>ERROR! Template cannot be blank.</xar:mlstring>
                    </div>
                </xar:if>
            </div>

            <div class="xar-form-input-wrapper">
                <label for="html" class="xar-form-label" title="#xarML('Send HTML messages?')#">
                    <xar:mlstring>Use HTML:</xar:mlstring>
                </label>
                <xar:if condition="$html">
                    <input type="checkbox" name="html" id="html" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="html" id="html" value="1" />
                </xar:if>
            </div>

            <div class="xar-form-input-wrapper">
                <label for="startday" class="xar-form-label" title="#xarML('Starting day for items to be included in each issue')#">
                    <xar:mlstring>Start Day</xar:mlstring>
                </label>
                <input type="text" name="startday" id="startday" size="3" maxlength="8" value="#$startday#" />
                <span class="xar-sub">
                    <xar:mlstring>Relative to issue date.  Use negative number to include days in the past.</xar:mlstring>
                </span>
                <xar:if condition="!empty($invalid['range'])">
                    <span class="xar-error"><xar:mlstring>Error!  Start date occurs after end date.</xar:mlstring></span>
                </xar:if>
            </div>

            <div class="xar-form-input-wrapper">
                <label for="endday" class="xar-form-label" title="#xarML('Ending day for items to be included in each issue')#">
                    <xar:mlstring>End Day</xar:mlstring>
                </label>
                <input type="text" name="endday" id="endday" size="3" maxlength="8" value="#$endday#" />
                <span class="xar-sub">
                    <xar:mlstring>Relative to issue date.  Use negative number to include days in the past.</xar:mlstring>
                </span>
            </div>

            <div class="xar-form-input-wrapper">
                <label for="defaulttheme" class="xar-form-label" title="#xarML('Default theme for generating issues')#">
                    <xar:mlstring>Default theme</xar:mlstring>
                </label>
                <select name="defaulttheme" id="defaulttheme">
                    <option value=""><xar:mlstring>[System Theme]</xar:mlstring></option>
                    <xar:loop name="$themes">
                        <xar:if condition="$loop:item['directory'] eq $defaulttheme">
                            <option value="#$loop:item['directory']#" selected="selected">
                                #$loop:item['name']#
                            </option>
                        <xar:else />
                            <option value="#$loop:item['directory']#">
                                #$loop:item['name']#
                            </option>
                        </xar:if>
                    </xar:loop>
                </select>
            </div>

        </fieldset>

        <xar:if condition="!empty($hookoutput)">
            <fieldset>
                <legend><xar:mlstring>Hooked content</xar:mlstring></legend>
                    <xar:foreach in="$hookoutput" value="$hook">
                        #$hook#
                    </xar:foreach>
            </fieldset>
        </xar:if>
        <fieldset>
            <div class="xar-form-input-wrapper-after">
                <input type="hidden" name="authid" id="authid" value="#$authid#" />
                <input type="submit" value="#xarML('Add Publication')#" />
            </div>
        </fieldset>

    </form>

</div>
