<xar:comment> License: GPL http://www.gnu.org/copyleft/gpl.html </xar:comment>

<div class="xar-mod-head"><span class="xar-mod-title">#$menutitle#</span></div>
<div class="xar-mod-body"><h2><xar:mlstring>Keyword Search</xar:mlstring></h2>
<div style="margin: auto;"><xar:template file="user-menu" type="module" />

<xar:base-include-javascript filename="booltoggle.js" position="head" />

<form action="&xar-modurl-bible-user-validate;" method="post" name="searchform">

    <fieldset>
        <div class="xar-form-input-wrapper-after">
            <input type="submit" value="#xarML('Search')#" />
        </div>
    </fieldset>

    <fieldset>
        <legend><xar:mlstring>Advanced Keyword Search Options</xar:mlstring></legend>

        <div class="xar-form-input-wrapper">
            <label for="sname" class="xar-form-label" title="#xarML('Text to search in')#">
                <xar:mlstring>Text:</xar:mlstring>
            </label>
        </div>
        <div class="xar-form-input-wrapper">
            <select name="sname">
                <xar:foreach in="$texts" value="$text">
                    <xar:if condition="!empty($sname) and $text.sname eq $sname">
                        <option value="#$text.sname#" selected="selected">#$text.sname# - #$text.lname#</option>
                    <xar:else />
                        <option value="#$text.sname#">#$text.sname# - #$text.lname#</option>
                    </xar:if>
                </xar:foreach>
            </select>
        </div>
        <br />
        <div class="xar-form-input-wrapper">
            <label for="searchtype" class="xar-form-label" title="#xarML('Type of search')#">
                <xar:mlstring>Search Type</xar:mlstring>
            </label>
            <select name="searchtype" id="type" onChange="boolToggle(this);">
                <option value=""><xar:mlstring>Auto Detect</xar:mlstring></option>
                <option value="normal"><xar:mlstring>Normal</xar:mlstring></option>
                <option value="fuzzy"><xar:mlstring>Fuzzy</xar:mlstring></option>
                <option value="boolean"><xar:mlstring>Boolean</xar:mlstring></option>
            </select>
        </div>

        <div class="xar-form-input-wrapper">
            <label for="words_1" class="xar-form-label" title="#xarML('Search Terms')#">
                <xar:mlstring>Search Terms</xar:mlstring>
            </label>
            <div class="xar-form-input-wrapper">
                <input type="text" name="words[]" id="words_1" class="xar-form-textmedium" />
                <select name="bools[]" id="bools[]" disabled="true" onChange="if(this.selectedIndex!=0)document.searchform.elements['type'].selectedIndex=3;">
                    <option value=""><xar:mlstring>---</xar:mlstring></option>
                    <option value=""><xar:mlstring>scored higher</xar:mlstring></option>
                    <option value="+"><xar:mlstring>present</xar:mlstring></option>
                    <option value="-"><xar:mlstring>not present</xar:mlstring></option>
                    <option value="~"><xar:mlstring>scored lower</xar:mlstring></option>
                </select>
            </div>
        </div>
        <div class="xar-form-input-wrapper">
            <label class="xar-form-label"><br /></label>
            <div class="xar-form-input-wrapper">
                <input type="text" name="words[]" class="xar-form-textmedium" />
                <select name="bools[]" id="bools[]" disabled="true" onChange="if(this.selectedIndex!=0)document.searchform.elements['type'].selectedIndex=3;">
                    <option value=""><xar:mlstring>---</xar:mlstring></option>
                    <option value=""><xar:mlstring>scored higher</xar:mlstring></option>
                    <option value="+"><xar:mlstring>present</xar:mlstring></option>
                    <option value="-"><xar:mlstring>not present</xar:mlstring></option>
                    <option value="~"><xar:mlstring>scored lower</xar:mlstring></option>
                </select>
            </div>
        </div>
        <div class="xar-form-input-wrapper">
            <label class="xar-form-label"><br /></label>
            <div class="xar-form-input-wrapper">
                <input type="text" name="words[]" class="xar-form-textmedium" />
                <select name="bools[]" id="bools[]" disabled="true" onChange="if(this.selectedIndex!=0)document.searchform.elements['type'].selectedIndex=3;">
                    <option value=""><xar:mlstring>---</xar:mlstring></option>
                    <option value=""><xar:mlstring>scored higher</xar:mlstring></option>
                    <option value="+"><xar:mlstring>present</xar:mlstring></option>
                    <option value="-"><xar:mlstring>not present</xar:mlstring></option>
                    <option value="~"><xar:mlstring>scored lower</xar:mlstring></option>
                </select>
            </div>
        </div>
        <div class="xar-form-input-wrapper">
            <label class="xar-form-label"><br /></label>
            <div class="xar-form-input-wrapper">
                <input type="text" name="words[]" class="xar-form-textmedium" />
                <select name="bools[]" id="bools[]" disabled="true" onChange="if(this.selectedIndex!=0)document.searchform.elements['type'].selectedIndex=3;">
                    <option value=""><xar:mlstring>---</xar:mlstring></option>
                    <option value=""><xar:mlstring>scored higher</xar:mlstring></option>
                    <option value="+"><xar:mlstring>present</xar:mlstring></option>
                    <option value="-"><xar:mlstring>not present</xar:mlstring></option>
                    <option value="~"><xar:mlstring>scored lower</xar:mlstring></option>
                </select>
            </div>
        </div>
        <div class="xar-form-input-wrapper">
            <label for="searchtype" class="xar-form-label" title="#xarML('Search limits')#">
                <xar:mlstring>Search Limits</xar:mlstring>
            </label>
            <br />
            <div class="xar-form-input-wrapper xar-sub">
                <xar:mlstring>If no limits are specified, the entire text will be searched.</xar:mlstring>
            </div>
        </div>
        <div class="xar-form-input-wrapper">
            <table width="90%">
            <tr><td valign="top">
                <xar:foreach in="$groupnames" key="$key" value="$value">
                    <nobr><input type="checkbox" name="limits[]" id="limit_#$key#" value="#$key#" />
                    <label for="limit_#$key#">#$value#</label></nobr><br />
                </xar:foreach>

            </td><td valign="top">
                <xar:foreach in="$aliases" key="$index" value="$value">
                    <xar:set name="$alias">preg_replace("/,.*\$/", '', $value[3]);</xar:set>
                    <nobr><input type="checkbox" name="limits[]" id="limit_#$alias#" value="#$alias#" />
                    <label for="limit_#$alias#">#$value[2]#</label></nobr><br />

                    <xar:if condition="($index + 1) % 22 eq 0">
                        </td><td valign="top">
                    </xar:if>

                </xar:foreach>
            </td></tr>
            </table>
        </div>
    </fieldset>

    <fieldset>
        <div class="xar-form-input-wrapper-after">
            <input type="hidden" name="function" value="view" />
            <input type="submit" value="#xarML('Search')#" />
        </div>
    </fieldset>

</form>

<script type="text/javascript"><!--
boolToggle(document.searchform.elements['type']);
//--></script>

</div>
</div>