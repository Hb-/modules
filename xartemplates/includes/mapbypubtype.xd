<xar:template xmlns:xar="http://xaraya.com/2004/blocklayout">
<!-- License: GPL http://www.gnu.org/copyleft/gpl.html -->
    <h2>
        <xar:mlstring>
            Article Map by Publication Type
        </xar:mlstring>
    </h2>
    <br />
    <form method="post" action="#$maplink#">
        <div>
            <xar:mlstring>
                Filter:
            </xar:mlstring>
            &#160;
            <select name="ptid" onchange="javascript:this.form.submit();">
                <option value="">
                    <xar:mlstring>
                        Publication
                    </xar:mlstring>
                </option>
                <xar:foreach in="$publinks" value="$pubtype">
                    <xar:if condition="!empty($ptid) and $pubtype['pubid'] eq $ptid">
                        <option value="#$pubtype['pubid']#" selected="selected">
                            - #$pubtype['pubtitle']#
                        </option>
                        <xar:else />
                        <option value="#$pubtype['pubid']#">
                            - #$pubtype['pubtitle']#
                        </option>
                    </xar:if>
                </xar:foreach>
            </select>
            <xar:foreach in="$catfilter" key="$cid">
                &#160;&#160;&#160;#$catfilter[$cid]#
            </xar:foreach>
            &#160;&#160;&#160; <input type="submit" name="go" value="Go" />
        </div>
    </form>
    <br />
    <br />
    <xar:foreach in="$publinks" value="$pubtype">
            <xar:if condition="!empty($ptid) and $pubtype['pubid'] ne $ptid">
                <xar:continue />
            </xar:if>
        <div class="xar-accent-outline">
            <div class="xar-title xar-accent xar-standard-box-padding">
                <xar:if condition="empty($pubtype['publink'])">
                    #$pubtype['pubtitle']#
                    <xar:else />
                    <a href="#$pubtype['publink']#">#$pubtype['pubtitle']#</a>
                </xar:if>
                <xar:if condition="!empty($pubtype['pubcount'])">
                    (#$pubtype['pubcount']#)
                </xar:if>
            </div>
            <div class="xar-standard-box-padding">
                <xar:foreach in="$pubtype['cats']" value="$childcats">
                    <xar:foreach in="$childcats" value="$cat">
                        #$cat['beforetags']#
                        <xar:if condition="!empty($cat['link'])">
                            <a href="#$cat['link']#">#$cat['name']#</a>
                            <xar:else />
                            #$cat['name']#
                        </xar:if>
                        <xar:if condition="!empty($cat['count'])">
                            (#$cat['count']#)
                        </xar:if>
                        #$cat['aftertags']#
                    </xar:foreach>
                </xar:foreach>
            </div>
        </div>
    </xar:foreach>
    <xar:template file="navtabs-user-map" type="module" />
</xar:template>
