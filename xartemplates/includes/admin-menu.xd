<xar:comment> License: GPL http://www.gnu.org/copyleft/gpl.html </xar:comment>
<xar:base-include-javascript position="head" module="base" filename="xmlhttprequest.js" />
<xar:base-include-javascript position="body" module="base" filename="calendar.js" />
<xar:base-include-javascript position="body" module="xtasks" filename="spinner.js" />
<xar:style scope="module" file="xtasks" />
<xar:style scope="module" module="base" file="navtabs" />

<xar:set name="activetab">$_bl_module_func</xar:set>

<xar:set name="mymemberid">xarModGetUserVar('xproject', 'mymemberid')</xar:set>

<xar:set name="dummy">xarVarFetch('module', 'str::', $currentmodname, '', XARVAR_NOT_REQUIRED)</xar:set>
<xar:set name="dummy">xarVarFetch('type', 'str::', $currentmodtype, '', XARVAR_NOT_REQUIRED)</xar:set>
<xar:set name="dummy">xarVarFetch('func', 'str::', $currentmodfunc, '', XARVAR_NOT_REQUIRED)</xar:set>

<div>
	<dl class="xar-tabs">
	    <dt class="help" title="#xarML('Choose an action to perform')#">
			<xar:mlstring>Actions:</xar:mlstring>
    	</dt>
		<xar:if condition="$mymemberid gt 0">
		    <xar:sec mask="ViewXTask" catch="false">
		        <xar:set name="tabclass">$activetab=='mytasks'?'active':''</xar:set>
		        <dd class="#$tabclass#">
		        	<a href="#xarModUrl('xtasks','user','mytasks')#">
		            	<xar:mlstring>My Tasks</xar:mlstring>
					</a>
		        </dd>
		    </xar:sec>
        </xar:if>
	    <xar:sec mask="ReadXTask" catch="false">
			<xar:if condition="$currentmodname eq 'xtasks' 
                    and $currentmodtype eq 'admin'
                    and $currentmodfunc eq 'view'">
	        	<xar:set name="tabclass">'active'</xar:set>
			<xar:else />
				<xar:set name="tabclass">''</xar:set>
			</xar:if>
	        <dd class="#$tabclass#">
				<a href="#xarModUrl('xtasks','admin','view')#">
					<xar:mlstring>Open Tasks</xar:mlstring>
				</a>
	        </dd>
	    </xar:sec>
	    <xar:sec mask="AddXTask" catch="false">
			<xar:if condition="$currentmodname eq 'xtasks' 
                    and $currentmodtype eq 'admin'
                    and $currentmodfunc eq 'new'">
	        	<xar:set name="tabclass">'active'</xar:set>
			<xar:else />
				<xar:set name="tabclass">''</xar:set>
			</xar:if>

	        <dd class="#$tabclass#">
	          <a href="#xarModUrl('xtasks','admin','new')#">
	            <xar:mlstring>New Task</xar:mlstring>
	          </a>
	        </dd>
	    </xar:sec>
	    <xar:sec mask="ReadXTask" catch="false">
	        <xar:set name="tabclass">$activetab=='settings'?'active':''</xar:set>
	        <dd class="#$tabclass#">
				<a href="#xarModUrl('xtasks','user','settings')#">
					<xar:mlstring>Preferences</xar:mlstring>
				</a>
	        </dd>
	    </xar:sec>
	    <xar:sec mask="ReadXTask" catch="false">
	        <xar:set name="tabclass">$activetab=='taskarchive'?'active':''</xar:set>
	        <dd class="#$tabclass#">
				<a href="#xarModUrl('xtasks','user','taskarchive')#">
					<xar:mlstring>Task Archive</xar:mlstring>
				</a>
	        </dd>
	    </xar:sec>
	    <xar:sec mask="ViewWorklog" catch="false">
			<xar:if condition="$currentmodname eq 'xtasks' 
                    and $currentmodtype eq 'worklog'
                    and $currentmodfunc eq 'view'">
	        	<xar:set name="tabclass">'active'</xar:set>
			<xar:else />
				<xar:set name="tabclass">''</xar:set>
			</xar:if>
	        <dd class="#$tabclass#">
				<a href="#xarModUrl('xtasks','worklog','view')#">
					<xar:mlstring>Worklog</xar:mlstring>
				</a>
	        </dd>
	    </xar:sec>
	    <xar:sec mask="AdminXTask" catch="false">
	        <xar:set name="tabclass">$activetab=='modifyconfig'?'active':''</xar:set>
	        <dd class="#$tabclass#">
	          <a href="#xarModUrl('xtasks','admin','modifyconfig')#">
	            <xar:mlstring>Modify Config</xar:mlstring>
	          </a>
	        </dd>
	    </xar:sec>
	    <xar:sec mask="ViewXTask" catch="false">
	    <xar:set name="tabclass">$activetab=='main'?'active':''</xar:set>
	    <dd class="#$tabclass#">
	      <a href="#xarModUrl('xtasks','user','main')#">
	        <xar:mlstring>Overview</xar:mlstring>
	      </a>
	    </dd>
	    </xar:sec>
	</dl>
</div>

<xar:if condition="!empty($statusmsg)">
    <div>#$statusmsg#</div>
</xar:if>
