<xar:comment> License: GPL http://www.gnu.org/copyleft/gpl.html </xar:comment>
<xar:base-include-javascript position="body" module="base" filename="xmlhttprequest.js" />
<xar:base-include-javascript position="body" module="xtasks" filename="spinner.js" />
<xar:set name="projects_objectid">xarModGetVar('xproject','projects_objectid')</xar:set>
<xar:data-getitem name="$properties" module="xProject" itemtype="1" itemid="$projects_objectid" />

<xar:set name="mymemberid">xarModGetUserVar('xproject', 'mymemberid')</xar:set>

<xar:if condition="$inline ne 1">
    <table border="0" width="100%">
    
        <tr><th align="center" colspan="2">#$menutitle#</th></tr>
        <tr>
            <td width="65" rowspan="2"><img src="modules/xproject/xarimages/admin.jpg" /></td>
            <td>
            <table border="0" width="100%"><tr align="center" valign="middle">
            
                <td width="25%"><a href="&xar-modurl-xproject-user-main;"><xar:mlstring>Published Projects</xar:mlstring></a></td>
                <td width="25%"><a href="&xar-modurl-xproject-admin-main;"><xar:mlstring>Search Projects</xar:mlstring></a></td>
                <td width="25%"><a href="&xar-modurl-xproject-admin-new;"><xar:mlstring>New Project</xar:mlstring></a></td>
                <td width="25%"><a href="&xar-modurl-xproject-user-settings;"><xar:mlstring>My Settings</xar:mlstring></a></td>
            
            </tr></table>
        </td></tr>
        <tr><td>
            <table border="0" width="100%"><tr align="center" valign="middle">
    
                <td width="25%"><xar:if condition="$mymemberid gt 0"><a href="&xar-modurl-xproject-admin-main;&amp;status=#$draftstatus#&amp;sortby=priority&amp;memberid=#$mymemberid#"><xar:mlstring>My Drafts</xar:mlstring></a></xar:if></td>
                <td width="25%"><xar:if condition="$mymemberid gt 0"><a href="&xar-modurl-xproject-admin-main;&amp;status=#$activestatus#&amp;sortby=priority&amp;memberid=#$mymemberid#"><xar:mlstring>My Active Projects</xar:mlstring></a></xar:if></td>
                <td width="25%"><a href="&xar-modurl-xproject-admin-main;&amp;status=#$archivestatus#"><xar:mlstring>Archive</xar:mlstring></a></td>
                <td width="25%"><a href="&xar-modurl-xproject-admin-modifyconfig;"><xar:mlstring>Configuration</xar:mlstring></a></td>
            
            </tr></table>
        </td></tr>
    
        <xar:if condition="!isset($q)">
            <xar:set name="q">""</xar:set>
        </xar:if>
        
        <style>
            .xar-sub select, .xar-sub input {
                font-size: 100%;
                }
        </style>
    
        <xar:if condition="!empty($showsearch)">
            <tr><td colspan="3" align="center" class="xar-sub">
                <xar:if condition="!isset($showajax)">
                    <xar:set name="action">"javascript:loadContent('&xar-modurl-xproject-admin-view;','projectlist','POST','searchprojects');"</xar:set>
                <xar:else />
                    <xar:set name="action">"&xar-modurl-xproject-admin-view;"</xar:set>
                </xar:if>
                <form method="post" action="#$action#" name="searchprojects" id="searchprojects" >
                
                <input type="hidden" name="sortby" value="#$sortby#" />
                
                <div style="margin: 2px;">
                    <xar:mlstring>Search: </xar:mlstring><input type="text" name="q" value="#$q#" size="10" />
                    <xar:data-input property="$properties['projecttype']" name="projecttype" value="$projecttype" />
                    <xar:mlstring>Min Importance: </xar:mlstring><xar:data-input property="$properties['importance']" name="max_importance" value="$max_importance" />
                    <xar:mlstring>Min Priority: </xar:mlstring><xar:data-input property="$properties['priority']" name="max_priority" value="$max_priority" />
                </div>
                
                <div style="margin: 2px;">
                    <xar:mlstring>Status: </xar:mlstring><xar:data-input property="$properties['status']" name="status" value="$status" />
                    <xar:if condition="count($teammembers) gt 0">
                        <select name="memberid">
                            <option value=""><xar:mlstring>Filter by Project Member</xar:mlstring></option>
                            <xar:foreach in="$teammembers" value="$memberinfo">
                                <xar:set name="member_id">$memberinfo['memberid']</xar:set>
                                <xar:if condition="$member_id eq $memberid" >
                                    <option value="#$memberinfo.memberid#" selected="selected">#$memberinfo.membername#</option>
                                <xar:else />
                                    <option value="#$memberinfo.memberid#">#$memberinfo.membername#</option>
                                </xar:if>
                            </xar:foreach>
                        </select>
                    </xar:if>
                    <input type="submit" value="Go"/>
                    <xar:data-input type="checkbox" name="verbose" value="$verbose" />&nbsp;<xar:mlstring>Details</xar:mlstring>
                </div>
                
                </form>
            </td></tr>
        </xar:if>    
    
        <xar:if condition="!empty($statusmsg)">
            <tr><td colspan="3" align="center"><strong>#$statusmsg#</strong></td></tr>
        </xar:if>
    
    </table>
    <br />
</xar:if>
