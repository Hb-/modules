<xar:template xmlns:xar="http://xaraya.com/2004/blocklayout">
    <xar:if condition="empty($layout)">
        <xar:set name="layout">'publications'</xar:set>
    </xar:if>
    <xar:if condition="($layout eq 'publications') or ($layout eq 'default')">
        <tr class="#$item_class#">
            <xar:template file="listingslist_rowprefix" module="$localmodule,listings" />
            <xar:foreach in="$fields" key="$field">
                <xar:set name="value">$loopitem[$field]</xar:set>
                <xar:set name="column">$columns[$field]</xar:set>
                <xar:if condition="$field eq $primaryalias AND !$showprimary">
                    <xar:continue />
                </xar:if>
                <xar:if condition="substr($field,0,1) eq 'c'">
                    <td>
                        #$value#
                    </td>
                <xar:else />
                    <td>
                        <xar:if condition="xarUserIsLoggedIn() AND $field eq $keyfieldalias AND xarSecurityCheck('EditListings',0)">
                            <a href="#xarModURL('publications','user','modify',array('itemid' =>$loopitem[$primaryalias], 'name' => $objectname,'tplmodule' => $localmodule))#">
                                <xar:data-output property="$properties[$column]" value="$value" />
                            </a>
                        <xar:else />
                            <xar:if condition="$field eq $keyfieldalias AND xarSecurityCheck('ReadListings',0)">
                                <a href="#xarModURL('publications','user','display',array('itemid' =>$loopitem[$primaryalias], 'name' => $objectname, 'tplmodule' => $localmodule))#">
                                    <xar:data-output property="$properties[$column]" value="$value" />
                                </a>
                            <xar:else />
                                <xar:data-output property="$properties[$column]" value="$value"/>
                            </xar:if>
                        </xar:if>
                    </td>

                </xar:if>
            </xar:foreach>

            <xar:template file="listingslist_rowsuffix" module="$localmodule,listings" />
        </tr>
    <xar:elseif condition="$layout eq 'pubtypes'" />
        <tr class="#$item_class#">
            <xar:template file="listingslist_rowprefix" module="$localmodule,listings" />
            <xar:foreach in="$fields" key="$field">
                <xar:set name="value">$loopitem[$field]</xar:set>
                <xar:set name="column">$columns[$field]</xar:set>
                <xar:if condition="$field eq $primaryalias AND !$showprimary">
                    <xar:continue />
                </xar:if>
                <xar:if condition="substr($field,0,1) eq 'c'">
                    <td>
                        #$value#
                    </td>
                <xar:else />
                    <td>
                        <xar:data-output property="$properties[$column]" value="$value"/>
                    </td>
                </xar:if>
            </xar:foreach>

            <xar:template file="listingslist_rowsuffix" module="$localmodule,listings" />
        </tr>
    </xar:if>
</xar:template>
