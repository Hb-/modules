<xar:comment>
    This renders a part of a delta tree
</xar:comment>

<xar:if condition="empty($deltatree)">
  <xar:mlstring>No deltas in this changeset</xar:mlstring>
<xar:else/>
    <ul class="subtree">
      <xar:foreach in="$deltatree" key="$nodename" value="$delta">
        <xar:if condition="$nodename != 'ChangeSet'">
          <xar:if condition="array_key_exists('type',$deltatree[$nodename]) && $deltatree[$nodename]['type']=='file'">
            <li class="node">
              <xar:foreach in="$deltatree[$nodename]" key="$field" value="$value">
                <xar:if condition="$field == 'type'"><xar:continue/></xar:if>
                <xar:template file="user-delta" subdata="$value"/>
              </xar:foreach>
            </li>
          <xar:else/>
            <li class="subtree">#$nodename#
              <!-- Recursive call into this very same template!! -->
              <xar:template file="deltatree" subdata="array('deltatree' =&gt; $deltatree[$nodename])" /> 
            </li>
          </xar:if>
        </xar:if>  
      </xar:foreach>
    </ul>
</xar:if>
