<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=#$gmapskey#" type="text/javascript"></script>
<xar:base-include-javascript position="head" module="gmaps" filename="map_init.js" />

<script type="text/javascript">
    //<![CDATA[
    if (window.attachEvent) {
        window.attachEvent("onload", function() {
            mapnumber = mapInit('gmaps_map',#$latitude#,#$longitude#,#$zoomlevel#); // Internet Explorer
            makeMapDataEntryMap(mapnumber,'gmaps_address','gmaps_latitude','gmaps_longitude','gmaps_latitude2','gmaps_longitude2');
        });
    } else {
        window.addEventListener("load", function() {
            mapnumber = mapInit('gmaps_map',#$latitude#,#$longitude#,#$zoomlevel#); // Firefox and standard browsers
            makeMapDataEntryMap(mapnumber,'gmaps_address','gmaps_latitude','gmaps_longitude','gmaps_latitude2','gmaps_longitude2');
        }, false);
    }
    //]]>
</script>

<form method="post" action="#xarModURL('gmaps','admin','create')#">
    <xar:comment>TODO: There may be multiple map divs on the same screen.  Need to ID each one uniquely</xar:comment>
    <fieldset>
        <legend>
            <xar:mlstring>
                Range 
            </xar:mlstring>
        </legend>
        <div class="xar-form-input-wrapper">
            <label for="gmaps_latitude" title="#xarML('Latitude 1')#" class="xar-form-label">
                <xar:mlstring>
                    Latitude 1: 
                </xar:mlstring>
            </label>
            <input type="text" name="gmaps_latitude" id="gmaps_latitude" value="" />
        </div>
        <div class="xar-form-input-wrapper">
            <label for="gmaps_longitude" title="#xarML('Longitude 1')#" class="xar-form-label">
                <xar:mlstring>
                    Longitude 1: 
                </xar:mlstring>
            </label>
            <input type="text" name="gmaps_longitude" id="gmaps_longitude" value="" />
        </div>
        <div class="xar-form-input-wrapper">
            <label for="gmaps_latitude2" title="#xarML('Latitude 2')#" class="xar-form-label">
                <xar:mlstring>
                    Latitude 2: 
                </xar:mlstring>
            </label>
            <input type="text" name="gmaps_latitude2" id="gmaps_latitude2" value="" />
        </div>
        <div class="xar-form-input-wrapper">
            <label for="gmaps_longitude2" title="#xarML('Longitude 2')#" class="xar-form-label">
                <xar:mlstring>
                    Longitude 2: 
                </xar:mlstring>
            </label>
            <input type="text" name="gmaps_longitude2" id="gmaps_longitude2" value="" />
        </div>
        <div class="xar-form-input-wrapper-after">
            <input type="submit" value="Save" />
        </div>
    </fieldset>
    <fieldset>
        <legend>
            <xar:mlstring>
                Location 
            </xar:mlstring>
        </legend>
        <div class="xar-form-input-wrapper">
            <label for="gmaps_address" title="#xarML('Latitude 1')#" class="xar-form-label">
                <xar:mlstring>
                    Coordinates: 
                </xar:mlstring>
            </label>
            <textarea name="gmaps_address" id="gmaps_address"></textarea>
        </div>
        <div class="xar-form-input-wrapper-after">
            <input type="button" value="Map Location" onClick="getGeoCode(mapnumber,'gmaps_address','gmaps_latitude','gmaps_longitude');return false;">
        </div>
    </fieldset>
    <div id="gmaps_map" style="width: #$mapwidth#px; height: #$mapheight#px"></div>
</form>