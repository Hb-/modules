<!-- the weather.com links are required -->
<xar:template file="weatherdotcomlogo" />
<xar:template file="weatherdotcomsearch" />

<div id="currentweather">
<h1 id="weatherCurrentHeader">
    <xar:ml>
        <xar:mlstring>Currently in #(1)</xar:mlstring>
        <xar:mlvar>#$wData.observStation#</xar:mlvar>
    </xar:ml>
</h1>
<table border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td valign="top" align="center">
            <img src="modules/weather/xarimages/icons/default/128/#$wData.icon#.png" />
        </td>
        <td valign="middle" align="right">
            <h1>#$wData.temp#&deg;#$wData.unitsTemp#</h1>
        </td>
    </tr>
    <tr>
        <td valign="top" align="center">
            <strong>#$wData.conditions#</strong>
        </td>
        <td valign="top" align="center">
            <strong><xar:mlstring>Feels Like</xar:mlstring><br />
            #$wData.feelsLike#&deg;#$wData.unitsTemp#</strong>
        </td>
    </tr>
</table>

<table border="0" cellpadding="2" cellspacing="0">
    <tr>
        <th><xar:mlstring>Today</xar:mlstring></th>
        <th><xar:mlstring>Tonight</xar:mlstring></th>
    </tr>
    <tr>
        <td valign="top" align="center">
            <xar:comment> TODO::use the tpl image apis here </xar:comment>
            <img src="modules/weather/xarimages/icons/default/32/#$eData[0]['part']['d']['icon']#.png" /><br />
            <strong>#$eData[0]['part']['d']['cond']#</strong><br />
        </td>
        <td valign="top" align="center">
            <xar:comment> TODO::use the tpl image apis here </xar:comment>
            <img src="modules/weather/xarimages/icons/default/32/#$eData[0]['part']['n']['icon']#.png" /><br />
            <strong>#$eData[0]['part']['n']['cond']#</strong><br />
        </td>
    </tr>
    <tr>
        <th><xar:mlstring>Daytime High</xar:mlstring>  (&deg;#$eData[0]['unitsTemp']#)</th>
        <th><xar:mlstring>Overnight Low</xar:mlstring>  (&deg;#$eData[0]['unitsTemp']#)</th>
    </tr>
    <tr>
        <td valign="top" align="center">
            <strong style="color:red;">#$eData[0]['hi']#&deg;</strong>
        </td>
        <td valign="top" align="center">
            <strong style="color:blue;">#$eData[0]['lo']#&deg;</strong>
        </td>
    </tr>
    <tr>
        <th><xar:mlstring>Sunrise</xar:mlstring></th>
        <th><xar:mlstring>Sunset</xar:mlstring></th>
    </tr>
    <tr>
        <td valign="top" align="center">
            <strong>#$eData[0]['sunr']#</strong>
        </td>
        <td valign="top" align="center">
            <strong>#$eData[0]['suns']#</strong>
        </td>
    </tr>
    <tr><th>&nbsp;</th><th>&nbsp;</th></tr>
    <tr><td nowrap="nowrap"><xar:mlstring><strong>UV Index:</xar:mlstring></strong></td><td nowrap="nowrap">#$wData.uv#&nbsp;#$wData.uvDesc#</td></tr>
    <tr><td nowrap="nowrap"><strong><xar:mlstring>Visibility:</xar:mlstring></strong></td><td nowrap="nowrap">#$wData.visibility#</td></tr>
    <tr><td nowrap="nowrap"><strong><xar:mlstring>Dew Point:</xar:mlstring></strong></td><td nowrap="nowrap">#$wData.dewPoint#&deg;#$wData.unitsTemp#</td></tr>
    <tr><td nowrap="nowrap"><strong><xar:mlstring>Humidity:</xar:mlstring></strong></td><td nowrap="nowrap">#$wData.humidity#%</td></tr>
    <tr><td nowrap="nowrap"><strong><xar:mlstring>Pressure:</xar:mlstring></strong></td><td nowrap="nowrap">
        <xar:ml>
            <xar:mlstring>#(1) #(2) and #(3)</xar:mlstring>
            <xar:mlvar>#$wData.barometer#</xar:mlvar>
            <xar:mlvar>#$wData.tempPressure#</xar:mlvar>
            <xar:mlvar>#$wData.barometerDesc#</xar:mlvar>
        </xar:ml>
    </td></tr>
    <tr><td nowrap="nowrap"><strong><xar:mlstring>Wind:</xar:mlstring></strong></td><td nowrap="nowrap">
        <xar:ml>
            <xar:mlstring>#(1) at #(2) #(3)</xar:mlstring>
            <xar:mlvar>#$wData.windDirname#</xar:mlvar>
            <xar:mlvar>#$wData.wind#</xar:mlvar>
            <xar:mlvar>#$wData.unitsSpeed#</xar:mlvar>
        </xar:ml>
    </td></tr>
    <tr><td nowrap="nowrap"><strong><xar:mlstring>Wind Gusts:</xar:mlstring></strong></td><td nowrap="nowrap">#$wData.windGust#&nbsp;#$wData.unitsSpeed#</td></tr>
    <tr>
        <td colspan="2" align="center">
            <p style="font-size:90%;">
            <xar:ml>
                <xar:mlstring>As reported at #(1). Last Updated #(2)</xar:mlstring>
                <xar:mlvar>#$wData.observStation#</xar:mlvar>
                <xar:mlvar>#$wData.lastUpdate#</xar:mlvar>
            </xar:ml>
        </td>
    </tr>
</table>
</div>

<xar:set name="$maxdays">#xarModGetUserVar('weather','extdays')#</xar:set>
<xar:set name="$switch">true</xar:set>
<div id="extendedforecast">
    <h1><xar:ml>
        <xar:mlstring>#(1)-Day Forecast</xar:mlstring>
        <xar:mlvar>#$maxdays#</xar:mlvar>    
        </xar:ml>
    </h1>
    <table width="100%" border="0" cellpadding="2" cellsapcing="0">
        <tr>
            <th colspan="3">&nbsp;</th>
            <th>
                <xar:mlstring>Daytime High</xar:mlstring> / <br />
                <xar:mlstring>Overnight Low</xar:mlstring><br />
                (&deg;#$eData[0]['unitsTemp']#)
            </th>
            <th><xar:mlstring>Precip. %</xar:mlstring></th>
        </tr>
        <!-- today's details -->
        <tr>
            <td valign="middle" align="left">
                <strong>
                <a href="#xarModURL('weather','user','details',array('xwday'=>0))#">#$eData[0]['wkday']#</a>
                </strong><br />#$eData[0]['date']#</td>
            <xar:comment> TODO::use the tpl image apis here </xar:comment>
            <td valign="middle" align="center"><img src="modules/weather/xarimages/icons/default/32/#$eData[0]['part']['d']['icon']#.png" /></td>
            <td valign="middle" align="center">#$eData[0]['part']['d']['cond']#</td>
            <td valign="middle" align="center"><strong>#$eData[0]['hi']#&deg;/#$eData[0]['lo']#&deg;</strong></td>
            <td valign="middle" align="center">#$eData[0]['part']['d']['ppcp']#%</td>
        </tr>
        <!-- extended forecast details -->
        <xar:for start="$i=1" test="$i <= $maxdays-1" iter="$i++">
        <xar:if condition="(bool)$switch">
            <xar:set name="$bgcolor">'bgcolor="#aaccff"'</xar:set>
            <xar:set name="$switch">false</xar:set>
        <xar:else />
            <xar:set name="$bgcolor">''</xar:set>
            <xar:set name="$switch">true</xar:set>
        </xar:if>
        <tr #$bgcolor#>
            <td valign="middle" align="left">
                <strong>
                <a href="#xarModURL('weather','user','details',array('xwday'=>$i))#">#$eData[$i]['wkday']#</a>
                </strong><br />#$eData[$i]['date']#</td>
            <xar:comment> TODO::use the tpl image apis here </xar:comment>
            <td valign="middle" align="center"><img src="modules/weather/xarimages/icons/default/32/#$eData[$i]['part']['d']['icon']#.png" /></td>
            <td valign="middle" align="center">#$eData[$i]['part']['d']['cond']#</td>
            <td valign="middle" align="center"><strong>#$eData[$i]['hi']#&deg;/#$eData[$i]['lo']#&deg;</strong></td>
            <td valign="middle" align="center">#$eData[$i]['part']['d']['ppcp']#%</td>
        </tr>
        </xar:for>
    </table>
</div>
 
<!-- the weather.com links are required -->
<xar:template file="weatherdotcomfull" />