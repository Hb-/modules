<xar:comment> License: GPL http://www.gnu.org/copyleft/gpl.html </xar:comment>

<xar:set name="objectlabel">#$object:label#</xar:set>

<xar:if condition="empty($objectlabel)">
  <h2><xar:mlstring>View Object</xar:mlstring></h2>

  <p>
    <xar:mlstring>
      This module presents an experimental <b>object-centric approach</b> [object=...&amp;method=...]
      to complement the normal <b>module-centric approach</b> [module=...&amp;func=...] used by Xaraya 1.0.
      Also available in Xaraya is a <b>BL-centric approach</b>, where the content of your site is determined
      entirely via templates, using the appropriate API calls, BL tags and sub-templates to handle the
      page requests.
    </xar:mlstring>
  </p>

  <p>
    <xar:mlstring>In order to try this out, you can specify a default object in xaruser/main.php, or pass it via the URL as object=...</xar:mlstring>
  </p>

  <p>
    <xar:mlstring>Here is a sample list of objects to get you started :</xar:mlstring>
  </p>

  <xar:set name="objects">xarModAPIFunc('dynamicdata','user','getobjects')</xar:set>
  <xar:set name="modid">xarModGetIDFromName('dynamicdata')</xar:set>
  <ul>
  <xar:foreach in="$objects" key="$itemid" value="$objectinfo">
    <xar:if condition="$itemid gt 2 and $objectinfo['moduleid'] eq $modid">
      <li><a href="#xarModURL('object','user','main',array('object' => $objectinfo['name']))#">#$objectinfo['label']#</a> </li>
    </xar:if>
  </xar:foreach>
  </ul>

<xar:else/>
  <h2><xar:ml><xar:mlstring>View #(1)</xar:mlstring><xar:mlvar>#$objectlabel#</xar:mlvar></xar:ml></h2>

  <xar:comment>
    Use the standard xar:data-view tag to benefit from DD's processing,
    but specify that the object template is located in this module too.
  </xar:comment>

  <xar:data-view object="$object" tplmodule="object" urlmodule="object" />

  <xar:set name="instance">#$object:moduleid . ':' . $object:itemtype . ':All'#</xar:set>
  <xar:if condition="xarSecurityCheck('AddDynamicDataItem',0,'Item',$instance)">
    <xar:set name="objectname">#$object:name#</xar:set>
    <a href="#xarModURL('object','user','main',array('object' => $objectname, 'method' => 'new'))#"><xar:mlstring>Create New</xar:mlstring></a>
  </xar:if>
</xar:if>
