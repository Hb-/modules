<xar:set name="worklog_objectid">xarModGetVar('xtasks','worklog_objectid')</xar:set>
<xar:data-getitem name="$properties" module="xTasks" itemtype="2" itemid="$worklog_objectid" />
<xar:set name="xtasks_objectid">xarModGetVar('xtasks','xtasks_objectid')</xar:set>
<xar:data-getitem name="$taskproperties" module="xTasks" itemtype="1" itemid="$xtasks_objectid" />

<xar:set name="uid">xarSessionGetVar('uid')</xar:set>
<xar:set name="currentdate">date("Y-m-d H:i:s")</xar:set>

<xar:if condition="!isset($hours_remaining)">
    <xar:set name="hours_remaining">0</xar:set>
</xar:if>


<div class="xar-mod-body">
	<xar:if condition="$inline">
		<fieldset>
		    <legend>
				<xar:mlstring>New Worklog Entry</xar:mlstring>
			</legend>
	<xar:else />
		<div class="xar-mod-head">
			<span class="xar-mod-title"><xar:mlstring>xTasks Worklog</xar:mlstring></span>
		</div>
	    <h2><xar:mlstring>New Worklog Entry</xar:mlstring></h2>

	    <xar:template type="module" file="admin-menu" />
	</xar:if>

    <form method="post" action="&xar-modurl-xtasks-worklog-create;">
    
		<div class="xar-form-input-wrapper">
		    <label for="eventdate_input" class="xar-form-label">
		        <xar:mlstring>Work Date</xar:mlstring>
		    </label>
		    <xar:data-input property="$properties['eventdate']" name="eventdate" value="$currentdate" />
		</div>
        
		<div class="xar-form-input-wrapper">
		    <label class="xar-form-label">
		        <xar:mlstring>Assigned To</xar:mlstring>
		    </label>
		    <xar:data-input property="$taskproperties['owner']" name="taskownerid" value="$taskinfo['owner']" />
		</div>

		<div class="xar-form-input-wrapper">
		    <label for="ownerid" class="xar-form-label">
		        <xar:mlstring>Performed By</xar:mlstring>
		    </label>
		    <xar:data-input property="$properties['ownerid']" name="ownerid" value="$uid" />
		</div>

		<div class="xar-form-input-wrapper">
		    <label for="hours" class="xar-form-label">
		        <xar:mlstring>Hours Worked</xar:mlstring>
		    </label>
		    <input type="text" name="hours" id="hours" class="xar-form-text-short" />
		</div>

		<div class="xar-form-input-wrapper">
		    <label for="hours_remaining" class="xar-form-label">
		        <xar:mlstring>Hours Remaining</xar:mlstring>
		    </label>
		    <xar:data-input property="$taskproperties['hours_remaining']" name="hours_remaining" value="$taskinfo['hours_remaining']" />
		</div>

		<div class="xar-form-input-wrapper-after">
		    <input type="checkbox" name="close" id="close" value="1" />
		    <label for="close">
		        <strong><xar:mlstring>Close Task?</xar:mlstring></strong>
		    </label>
		</div>

		<div class="xar-form-input-wrapper">
		    <label for="notes" class="xar-form-label">
		        <xar:mlstring>Notes</xar:mlstring>
		    </label>
		    <xar:data-input property="$properties['notes']" name="notes" />
		</div>


        
		<div class="xar-align-center xar-margin-thickends">
	        <input type="hidden" name="authid" id="authid" value="#xarSecGenAuthKey('xtasks')#" />
	        <input type="hidden" name="taskid" value="#$taskid#" />
	        <input type="hidden" name="returnurl" value="#$returnurl#" />
			<input type="submit" name="submit" value="#xarML('Submit Work')#" />
		</div>
    
    </form>

	<xar:if condition="$inline">
		</fieldset>
	</xar:if>
</div>
