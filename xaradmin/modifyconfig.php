<?php
/**
   This is a standard function to modify the configuration parameters of the
   module

   @return template data
*/
function helpdesk_admin_modifyconfig()
{
    // Security check - important to do this as early as possible to avoid
    // potential security holes or just too much wasted processing
    if (!xarSecurityCheck('adminhelpdesk')) { return; }

    // Add menu to output - it helps if all of the module pages have a standard
    // menu at their head to aid in navigation
    $data['menutitle'] = xarModAPIFunc('helpdesk', 'admin', 'menu');

    // Add an authorisation ID - this adds a hidden field in the form that
    // contains an authorisation ID.  The authorisation ID is very important in
    // preventing certain attacks on the website
    $data['enforceauthkey'] = xarModGetVar('helpdesk', 'EnforceAuthKey');
    $data['authid'] = xarSecGenAuthKey();

    if (!xarVarFetch('itemtype', 'int', $itemtype, 1, XARVAR_NOT_REQUIRED)) return;

    $hooks = xarModCallHooks('module', 'modifyconfig', 'helpdesk',
                            array('module'   => 'helpdesk',
                                  'itemtype' => $itemtype));
    if (empty($hooks)) {
        $data['hooks'] = '';
    } elseif (is_array($hooks)) {
        $data['hooks'] = join('',$hooks);
    } else {
        $data['hooks'] = $hooks;
    }

    // Return the output that has been generated by this function
    return $data;
}
?>
