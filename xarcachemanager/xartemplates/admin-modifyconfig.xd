<xar:comment> License: GPL http://www.gnu.org/copyleft/gpl.html </xar:comment>
<div class="xar-mod-head"><span class="xar-mod-title"><xar:mlstring>xarCacheManager Administration</xar:mlstring></span></div>
<div class="xar-mod-body"><h2><xar:mlstring>Configuration</xar:mlstring></h2>
<div style="margin: auto;">
<form action="#xarModURL('xarcachemanager', 'admin', 'updateconfig')#" method="post" enctype="application/x-www-form-urlencoded" >
    <table border="0" cellpadding="8" cellspacing="0">
        <tr>
            <td colspan="2"><h3><xar:mlstring>Global Settings</xar:mlstring></h3></td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('Stores the output generated by Xaraya in a cache for low latency/low overhead serving.')#">
            <label for="cacheenabled">
                <xar:mlstring>Enable the Output Caching System:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="$CachingEnabled eq 1 ">
                    <input type="checkbox" name="cacheenabled" id="cacheenabled" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="cacheenabled" id="cacheenabled" value="1" />
                    <span class="help" style="color: red; " title="#xarML('Config options can be modified, but no output caching will happen until enabled.')#">
                        <xar:mlstring>Output caching is disabled.</xar:mlstring>
                    </span>
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If not sure, select the default theme.')#"><label for="cachetheme">
                <xar:mlstring>Cache the Output of this Theme:</xar:mlstring>
            </label></span></td>
            <td>
                <select name="cachetheme" id="cachetheme" size="1">
                    <option value="">All Themes</option>
                    <xar:loop name="$themes">
                        <xar:if condition="$loop:item['name'] eq $settings.OutputDefaultTheme">
                            <option value="#$loop:item['name']#" selected="selected">
                                #$loop:item['name']#
                            </option>
                            <xar:else />
                            <option value="#$loop:item['name']#">
                                #$loop:item['name']#
                            </option>
                        </xar:if>
                    </xar:loop>
                </select>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('Limits the disk usage of the output cache to the specified number of megabytes.')#">
            <label for="cachesizelimit">
                <xar:mlstring>Cache Size Limit (in MB):</xar:mlstring>
            </label></span></td>
            <td>
                <input type="text" name="cachesizelimit" id="cachesizelimit" value="#$settings.OutputSizeLimit#" size="4" maxlength="4" />
            </td>
        </tr>
        <tr>
            <td colspan="2"><h3><xar:mlstring>Page Output Cache Settings</xar:mlstring></h3></td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If enabled, the pages generated by Xaraya are cached for reuse.')#">
            <label for="cachepages">
                <xar:mlstring>Enable Page Output Caching:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="$pageCachingEnabled eq 1 ">
                    <input type="checkbox" name="cachepages" id="cachepages" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="cachepages" id="cachepages" value="1" />
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('The maximum lifetime of a cached page. Set to zero for no time based expiration.')#">
            <label for="pageexpiretime">
                <xar:mlstring>Page Cache Expiration Time (in hh:mm:ss):</xar:mlstring>
            </label></span></td>
            <td>
                <input type="text" name="pageexpiretime" id="pageexpiretime" value="#$settings.PageTimeExpiration#" size="9" maxlength="9" />
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If selected, individual item display pages will be cached.')#">
            <label for="cachedisplayview">
                <xar:mlstring>Cache Item Display Pages:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="$settings.PageDisplayView eq 1 ">
                    <input type="checkbox" name="cachedisplayview" id="cachedisplayview" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="cachedisplayview" id="cachedisplayview" value="1" />
                </xar:if>
            </td>
        </tr>
        <xar:if condition="$settings.PageDisplayView eq 1 ">
        <tr>
            <td><span class="help" title="#xarML('If selected, the cache will be invalidated when new comments are posted for an item.')#">
            <label for="cacheflushcomment">
                <xar:mlstring>Flush Cached Display Page on New Comment:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="xarModGetVar('xarcachemanager','FlushOnNewComment')">
                    <input type="checkbox" name="cacheflushcomment" id="cacheflushcomment" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="cacheflushcomment" id="cacheflushcomment" value="1" />
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If selected, the cache will be invalidated when a rating is posted for an item.')#">
            <label for="cacheflushrating">
                <xar:mlstring>Flush Cached Display Page on New Rating:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="xarModGetVar('xarcachemanager','FlushOnNewRating')">
                    <input type="checkbox" name="cacheflushrating" id="cacheflushrating" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="cacheflushrating" id="cacheflushrating" value="1" />
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If selected, the cache will be invalidated when a vote is caste on a poll hooked to an item.')#">
            <label for="cacheflushpollvote">
                <xar:mlstring>Flush Cached Display Page on New Hooked Poll Vote:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="xarModGetVar('xarcachemanager','FlushOnNewPollvote')">
                    <input type="checkbox" name="cacheflushpollvote" id="cacheflushpollvote" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="cacheflushpollvote" id="cacheflushpollvote" value="1" />
                </xar:if>
            </td>
        </tr>
        </xar:if>
        <tr>
            <td><span class="help" title="#xarML('Adds a line to the bottom of cached pages stating the cache time.')#">
            <label for="cachetimestamp">
                <xar:mlstring>Show the "Last Modified" Stamp on Cached Pages:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="$settings.PageShowTime eq 1 ">
                    <input type="checkbox" name="cachetimestamp" id="cachetimestamp" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="cachetimestamp" id="cachetimestamp" value="1" />
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If enabled, xarCache will send Expires and Cache-Control headers to the client, encouraging the page to be cached locally')#">
            <label for="expireheader">
                <xar:mlstring>Allow clients to reuse locally cached pages without re-validation:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="$settings.PageExpireHeader eq 1 ">
                    <input type="checkbox" name="expireheader" id="expireheader" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="expireheader" id="expireheader" value="1" />
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If enabled, the cache of the session-less URLs will be regenerated upon event-based invalidation, triggered by creage/update/delete hooks')#">
            <label for="autoregenerate">
                <xar:mlstring>Auto-regenerate cache of session-less URL list:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="xarModGetVar('xarcachemanager','AutoRegenSessionless')">
                    <input type="checkbox" name="autoregenerate" id="autoregenerate" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="autoregenerate" id="autoregenerate" value="1" />
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If enabled, xarCache will only cache the pages of modules that have been hooked to the xarCacheModule.
            Note: this will not prevent cached pages from being served, only stop new pages from being cached.')#">
            <label for="pagehookedonly">
                <xar:mlstring>Only cache pages of modules hooked to xarCacheManger:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="$settings.PageHookedOnly eq 1 ">
                    <input type="checkbox" name="pagehookedonly" id="pagehookedonly" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="pagehookedonly" id="pagehookedonly" value="1" />
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('Specify where the cached data should be stored.')#">
            <label for="pagecachestorage">
                <xar:mlstring>Page Cache Storage:</xar:mlstring>
            </label></span></td>
            <td>
                <select name="pagecachestorage" id="pagecachestorage">
                    <xar:if condition="$settings['PageCacheStorage'] eq 'filesystem'">
                        <option value="filesystem" selected="selected"><xar:mlstring>Filesystem</xar:mlstring></option>
                    <xar:else/>
                        <option value="filesystem"><xar:mlstring>Filesystem</xar:mlstring></option>
                    </xar:if>
                    <xar:if condition="$settings['PageCacheStorage'] eq 'database'">
                        <option value="database" selected="selected"><xar:mlstring>Database</xar:mlstring></option>
                    <xar:else/>
                        <option value="database"><xar:mlstring>Database</xar:mlstring></option>
                    </xar:if>
                    <xar:if condition="!extension_loaded('memcache')">
                        <option value="memcached" disabled="disabled"><xar:mlstring>Memcache</xar:mlstring></option>
                    <xar:elseif condition="$settings['PageCacheStorage'] eq 'memcached'"/>
                        <option value="memcached" selected="selected"><xar:mlstring>Memcache</xar:mlstring></option>
                    <xar:else/>
                        <option value="memcached"><xar:mlstring>Memcache</xar:mlstring></option>
                    </xar:if>
                    <xar:if condition="!function_exists('mmcache')">
                        <option value="mmcache" disabled="disabled"><xar:mlstring>Turck MMCache</xar:mlstring></option>
                    <xar:elseif condition="$settings['PageCacheStorage'] eq 'mmcache'"/>
                        <option value="mmcache" selected="selected"><xar:mlstring>Turck MMCache</xar:mlstring></option>
                    <xar:else/>
                        <option value="mmcache"><xar:mlstring>Turck MMCache</xar:mlstring></option>
                    </xar:if>
                    <xar:if condition="!function_exists('eaccelerator')">
                        <option value="eaccelerator" disabled="disabled"><xar:mlstring>eAccelerator</xar:mlstring></option>
                    <xar:elseif condition="$settings['PageCacheStorage'] eq 'eaccelerator'"/>
                        <option value="eaccelerator" selected="selected"><xar:mlstring>eAccelerator</xar:mlstring></option>
                    <xar:else/>
                        <option value="eaccelerator"><xar:mlstring>eAccelerator</xar:mlstring></option>
                    </xar:if>
                </select>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('Limits the disk usage of the page cache to the specified number of megabytes.')#">
            <label for="pagesizelimit">
                <xar:mlstring>Page Cache Size Limit (in MB):</xar:mlstring>
            </label></span></td>
            <td>
                <input type="text" name="pagesizelimit" id="pagesizelimit" value="#$settings.PageSizeLimit#" size="4" maxlength="4" />
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('Specify if cache hits and misses should be logged, e.g. in var/logs/page.log')#">
            <label for="pagelogfile">
                <xar:mlstring>Page Cache Logfile:</xar:mlstring>
            </label></span></td>
            <td>
                <input type="text" name="pagelogfile" id="pagelogfile" value="#$settings.PageLogFile#" size="20" />
            </td>
        </tr>
        <tr>
            <td colspan="2"><h3><xar:mlstring>Block Output Cache Settings</xar:mlstring></h3></td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('If enabled, block output will be cached for reuse.  Please enable hooks to blocks for per instance configuration options.')#">
            <label for="cacheblocks">
                <xar:mlstring>Enable Block Output Caching:</xar:mlstring>
            </label></span></td>
            <td>
                <xar:if condition="$blockCachingEnabled eq 1 ">
                    <input type="checkbox" name="cacheblocks" id="cacheblocks" value="1" checked="checked" />
                <xar:else />
                    <input type="checkbox" name="cacheblocks" id="cacheblocks" value="1" />
                </xar:if>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('The default maximum lifetime of a cached block. Set to zero for no time based expiration.')#">
            <label for="blockexpiretime">
                <xar:mlstring>Block Cache Expiration Time (in hh:mm:ss):</xar:mlstring>
            </label></span></td>
            <td>
                <input type="text" name="blockexpiretime" id="blockexpiretime" value="#$settings.BlockTimeExpiration#" size="9" maxlength="9" />
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('Specify where the cached data should be stored.')#">
            <label for="blockcachestorage">
                <xar:mlstring>Block Cache Storage:</xar:mlstring>
            </label></span></td>
            <td>
                <select name="blockcachestorage" id="blockcachestorage">
                    <xar:if condition="$settings['BlockCacheStorage'] eq 'filesystem'">
                        <option value="filesystem" selected="selected"><xar:mlstring>Filesystem</xar:mlstring></option>
                    <xar:else/>
                        <option value="filesystem"><xar:mlstring>Filesystem</xar:mlstring></option>
                    </xar:if>
                    <xar:if condition="$settings['BlockCacheStorage'] eq 'database'">
                        <option value="database" selected="selected"><xar:mlstring>Database</xar:mlstring></option>
                    <xar:else/>
                        <option value="database"><xar:mlstring>Database</xar:mlstring></option>
                    </xar:if>
                    <xar:if condition="!extension_loaded('memcache')">
                        <option value="memcached" disabled="disabled"><xar:mlstring>Memcache</xar:mlstring></option>
                    <xar:elseif condition="$settings['BlockCacheStorage'] eq 'memcached'"/>
                        <option value="memcached" selected="selected"><xar:mlstring>Memcache</xar:mlstring></option>
                    <xar:else/>
                        <option value="memcached"><xar:mlstring>Memcache</xar:mlstring></option>
                    </xar:if>
                    <xar:if condition="!function_exists('mmcache')">
                        <option value="mmcache" disabled="disabled"><xar:mlstring>Turck MMCache</xar:mlstring></option>
                    <xar:elseif condition="$settings['BlockCacheStorage'] eq 'mmcache'"/>
                        <option value="mmcache" selected="selected"><xar:mlstring>Turck MMCache</xar:mlstring></option>
                    <xar:else/>
                        <option value="mmcache"><xar:mlstring>Turck MMCache</xar:mlstring></option>
                    </xar:if>
                    <xar:if condition="!function_exists('eaccelerator')">
                        <option value="eaccelerator" disabled="disabled"><xar:mlstring>eAccelerator</xar:mlstring></option>
                    <xar:elseif condition="$settings['BlockCacheStorage'] eq 'eaccelerator'"/>
                        <option value="eaccelerator" selected="selected"><xar:mlstring>eAccelerator</xar:mlstring></option>
                    <xar:else/>
                        <option value="eaccelerator"><xar:mlstring>eAccelerator</xar:mlstring></option>
                    </xar:if>
                </select>
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('Limits the disk usage of the block cache to the specified number of megabytes.')#">
            <label for="blocksizelimit">
                <xar:mlstring>Block Cache Size Limit (in MB):</xar:mlstring>
            </label></span></td>
            <td>
                <input type="text" name="blocksizelimit" id="blocksizelimit" value="#$settings.BlockSizeLimit#" size="4" maxlength="4" />
            </td>
        </tr>
        <tr>
            <td><span class="help" title="#xarML('Specify if cache hits and misses should be logged, e.g. in var/logs/block.log')#">
            <label for="blocklogfile">
                <xar:mlstring>Block Cache Logfile:</xar:mlstring>
            </label></span></td>
            <td>
                <input type="text" name="blocklogfile" id="blocklogfile" value="#$settings.BlockLogFile#" size="20" />
            </td>
        </tr>
    </table>
    <p>
        <input type="hidden" name="authid" id="authid" value="#$authid#" />
        <input type="submit" value="Update xarCacheManager Configuration" />
    </p>
</form>
</div>
</div>
