<xar:comment> License: GPL http://www.gnu.org/copyleft/gpl.html </xar:comment>
<xar:if condition="xarTplAddStyleLink('base', 'navtabs')">
</xar:if>
<div class="xar-mod-head"><span class="xar-mod-title"><xar:mlstring>xarCacheManager Administration</xar:mlstring></span></div>
<div class="xar-mod-body"><h2><xar:mlstring>Cache Statistics</xar:mlstring></h2>
    <div>
        <dl class="xar-tabs">
            <dt class="help">
                <xar:mlstring>
                    Select
                </xar:mlstring>
                : 
            </dt>
            <xar:if condition="empty($tab) or $tab eq 'overview'">
                <dd class="active">
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'overview'))#">
                        <xar:mlstring>Overview</xar:mlstring>
                    </a>
                </dd>    
            <xar:else />
                <dd>
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'overview'))#">    
                        <xar:mlstring>Overview</xar:mlstring>
                    </a>
                </dd>    
            </xar:if>
            <xar:if condition="$tab eq 'page'">
                <dd class="active">
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'page'))#">
                        <xar:mlstring>Page</xar:mlstring>
                    </a>
                </dd>    
            <xar:else />
                <dd>
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'page'))#">    
                        <xar:mlstring>Page</xar:mlstring>
                    </a>
                </dd>    
            </xar:if>
            <xar:if condition="$tab eq 'block'">
                <dd class="active">
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'block'))#">
                        <xar:mlstring>Block</xar:mlstring>
                    </a>
                </dd>    
            <xar:else />
                <dd>
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'block'))#">    
                        <xar:mlstring>Block</xar:mlstring>
                    </a>
                </dd>    
            </xar:if>
            <xar:if condition="$tab eq 'query'">
                <dd class="active">
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'query'))#">
                        <xar:mlstring>Query</xar:mlstring>
                    </a>
                </dd>    
            <xar:else />
                <dd>
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'query'))#">    
                        <xar:mlstring>Query</xar:mlstring>
                    </a>
                </dd>    
            </xar:if>
            <xar:if condition="$tab eq 'autocache'">
                <dd class="active">
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'autocache'))#">
                        <xar:mlstring>Auto-Cache</xar:mlstring>
                    </a>
                </dd>    
            <xar:else />
                <dd>
                    <a href="#xarModURL('xarcachemanager', 'admin', 'stats', array('tab' => 'autocache'))#">    
                        <xar:mlstring>Auto-Cache</xar:mlstring>
                    </a>
                </dd>    
            </xar:if>
        </dl>
    </div>
    
    
    <div style="border: 1px solid #ccc; text-align: left; width: 100%; border-top: none; padding-left: 5px;">
    <xar:comment> ------------------- Begin Overview Statistics --------------------- </xar:comment>
    <br />
    <xar:if condition="empty($tab) or $tab eq 'overview'">

    <table class="xar-norm">
    <tr>
      <td valign="top">

        <h3><xar:mlstring>Page Cache</xar:mlstring></h3>

        <xar:if condition="!empty($pageCachingEnabled)">
        <table class="xar-norm">
            <tr>
                <th>
                    <xar:mlstring>Storage</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($settings['PageCacheStorage'])">
                        #$settings['PageCacheStorage']#
                    </xar:if>
                </td>
            </tr>
            <tr>
                <th>
                    <xar:mlstring>Items</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($pagecacheitems)">
                        #$pagecacheitems#
                    </xar:if>
                </td>
            </tr>
            <tr>
                <th>
                    <xar:mlstring>Size</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($pagecachesize)">
                        #$pagecachesize#
                    </xar:if>
                </td>
            </tr>
            <tr>
                <th>
                    <xar:mlstring>Logfile</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($settings['PageLogFile'])">
                        #$settings['PageLogFile']#
                    </xar:if>
                </td>
            </tr>
            <xar:if condition="!empty($settings['PageLogFile'])">
                <tr>
                    <th>
                        <xar:mlstring>Entries</xar:mlstring>
                    </th>
                    <td>
                        #$pageloglines#
                    </td>
                </tr>
                <tr>
                    <th>
                        <xar:mlstring>Logsize</xar:mlstring>
                    </th>
                    <td>
                        #$pagelogsize#
                    </td>
                </tr>
            </xar:if>
        </table>
        <xar:else/>
            <xar:mlstring>Disabled</xar:mlstring>
        </xar:if>

      </td>
      <td valign="top">

        <h3><xar:mlstring>Block Cache</xar:mlstring></h3>

        <xar:if condition="!empty($blockCachingEnabled)">
        <table class="xar-norm">
            <tr>
                <th>
                    <xar:mlstring>Storage</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($settings['BlockCacheStorage'])">
                        #$settings['BlockCacheStorage']#
                    </xar:if>
                </td>
            </tr>
            <tr>
                <th>
                    <xar:mlstring>Items</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($blockcacheitems)">
                        #$blockcacheitems#
                    </xar:if>
                </td>
            </tr>
            <tr>
                <th>
                    <xar:mlstring>Size</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($blockcachesize)">
                        #$blockcachesize#
                    </xar:if>
                </td>
            </tr>
            <tr>
                <th>
                    <xar:mlstring>Logfile</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($settings['BlockLogFile'])">
                        #$settings['BlockLogFile']#
                    </xar:if>
                </td>
            </tr>
            <xar:if condition="!empty($settings['BlockLogFile'])">
                <tr>
                    <th>
                        <xar:mlstring>Entries</xar:mlstring>
                    </th>
                    <td>
                        #$blockloglines#
                    </td>
                </tr>
                <tr>
                    <th>
                        <xar:mlstring>Logsize</xar:mlstring>
                    </th>
                    <td>
                        #$blocklogsize#
                    </td>
                </tr>
            </xar:if>
        </table>
        <xar:else/>
            <xar:mlstring>Disabled</xar:mlstring>
        </xar:if>

      </td>
    </tr>
    <tr>
      <td valign="top">

        <h3><xar:mlstring>Query Cache</xar:mlstring></h3>

        <xar:if condition="!empty($queryCachingEnabled)">
        <table class="xar-norm">
            <tr>
                <th>
                    <xar:mlstring>Storage</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($settings['QueryCacheStorage'])">
                        #$settings['QueryCacheStorage']#
                    </xar:if>
                </td>
            </tr>
            <tr>
                <th>
                    <xar:mlstring>Items</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($querycacheitems)">
                        #$querycacheitems#
                    </xar:if>
                </td>
            </tr>
            <tr>
                <th>
                    <xar:mlstring>Size</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($querycachesize)">
                        #$querycachesize#
                    </xar:if>
                </td>
            </tr>
        </table>
        <xar:else/>
            <!-- xar:mlstring>Disabled</xar:mlstring -->
        </xar:if>

      </td>
      <td valign="top">

        <h3><xar:mlstring>Auto-Cache</xar:mlstring></h3>

        <xar:if condition="!empty($autoCachingEnabled)">
        <table class="xar-norm">
            <tr>
                <th>
                    <xar:mlstring>Logfile</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($settings['AutoCacheLogFile'])">
                        #$settings['AutoCacheLogFile']#
                    </xar:if>
                </td>
            </tr>
            <xar:if condition="!empty($settings['AutoCacheLogFile'])">
                <tr>
                    <th>
                        <xar:mlstring>Entries</xar:mlstring>
                    </th>
                    <td>
                        #$autocacheloglines#
                    </td>
                </tr>
                <tr>
                    <th>
                        <xar:mlstring>Logsize</xar:mlstring>
                    </th>
                    <td>
                        #$autocachelogsize#
                    </td>
                </tr>
            </xar:if>
            <tr>
                <th>
                    <xar:mlstring>Statfile</xar:mlstring>
                </th>
                <td>
                    <xar:if condition="!empty($settings['AutoCacheStatFile'])">
                        #$settings['AutoCacheStatFile']#
                    </xar:if>
                </td>
            </tr>
            <xar:if condition="!empty($settings['AutoCacheStatFile'])">
                <tr>
                    <th>
                        <xar:mlstring>Entries</xar:mlstring>
                    </th>
                    <td>
                        #$autocachestatlines#
                    </td>
                </tr>
                <tr>
                    <th>
                        <xar:mlstring>Statsize</xar:mlstring>
                    </th>
                    <td>
                        #$autocachestatsize#
                    </td>
                </tr>
            </xar:if>
        </table>
        <xar:else/>
            <xar:mlstring>Disabled</xar:mlstring>
        </xar:if>

      </td>
    </tr>
    </table>

    <xar:comment> ----------------- Begin Page Statistics ------------------- </xar:comment>
    <xar:elseif condition="$tab eq 'page'" />

        <h3><xar:mlstring>Page Cache Statistics</xar:mlstring></h3>

        <table class="xar-norm">
        <tr>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'page','sort' => 'size'))#"><xar:mlstring>Size</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'page','sort' => 'key'))#"><xar:mlstring>Key</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'page','sort' => 'code'))#"><xar:mlstring>Code</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'page','sort' => 'time'))#"><xar:mlstring>Time</xar:mlstring></a></th>
        </tr>
        <xar:foreach in="$items" key="$id" value="$item">
        <tr>
          <td>#$item['size']#</td>
          <td>#$item['key']#</td>
          <td>#$item['code']#</td>
          <td>#xarLocaleFormatDate('%a, %d %B %Y %H:%M:%S %Z',$item['time'])#</td>
        </tr>
        </xar:foreach>
        </table>
        <xar:mlstring>to be defined</xar:mlstring>

    <xar:comment> ----------------- Begin Block Statistics ------------------- </xar:comment>
    <xar:elseif condition="$tab eq 'block'" />

        <h3><xar:mlstring>Block Cache Statistics</xar:mlstring></h3>
        <table class="xar-norm">
        <tr>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'block','sort' => 'size'))#"><xar:mlstring>Size</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'block','sort' => 'key'))#"><xar:mlstring>Key</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'block','sort' => 'code'))#"><xar:mlstring>Code</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'block','sort' => 'time'))#"><xar:mlstring>Time</xar:mlstring></a></th>
        </tr>
        <xar:foreach in="$items" key="$id" value="$item">
        <tr>
          <td>#$item['size']#</td>
          <td>#$item['key']#</td>
          <td>#$item['code']#</td>
          <td>#xarLocaleFormatDate('%a, %d %B %Y %H:%M:%S %Z',$item['time'])#</td>
        </tr>
        </xar:foreach>
        </table>
        <xar:mlstring>to be defined</xar:mlstring>

    <xar:comment> ----------------- Begin Query Statistics ------------------- </xar:comment>
    <xar:elseif condition="$tab eq 'query'" />

        <h3><xar:mlstring>Query Cache Statistics</xar:mlstring></h3>
        <xar:mlstring>to be defined</xar:mlstring>

    <xar:comment> ----------------- Begin Auto-Cache Statistics ------------------- </xar:comment>
    <xar:elseif condition="$tab eq 'autocache'" />

        <h3><xar:mlstring>Auto-Cache Statistics</xar:mlstring></h3>
        <form method="post" action="#xarModURL('xarcachemanager', 'admin', 'stats')#">
          <input type="hidden" name="tab" id="tab" value="autocache" />
          <input type="hidden" name="authid" id="authid" value="#xarSecGenAuthKey()#" />
          <input type="submit" name="reset" value="#xarML('Reset')#" />
        </form>
        <table class="xar-norm">
        <tr>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'autocache','sort' => 'ratio'))#"><xar:mlstring>Ratio</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'autocache','sort' => 'hit'))#"><xar:mlstring>Hit</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'autocache','sort' => 'miss'))#"><xar:mlstring>Miss</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'autocache','sort' => 'total'))#"><xar:mlstring>Total</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'autocache','sort' => 'first'))#"><xar:mlstring>First Seen</xar:mlstring></a></th>
          <th><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'autocache','sort' => 'last'))#"><xar:mlstring>Last Seen</xar:mlstring></a></th>
        </tr>
        <tr>
          <th colspan="6"><a href="#xarModURL('xarcachemanager','admin','stats',array('tab' => 'autocache','sort' => 'page'))#"><xar:mlstring>Page</xar:mlstring></a></th>
        </tr>
        <xar:foreach in="$autocachestats" key="$page" value="$count">
        <tr class="xar-alt">
          <td>#$count['ratio']#%</td>
          <td>#$count['hit']#</td>
          <td>#$count['miss']#</td>
          <td>#$count['total']#</td>
          <td>#xarLocaleFormatDate('%a, %d %B %Y %H:%M:%S %Z',$count['first'])#</td>
          <td>#xarLocaleFormatDate('%a, %d %B %Y %H:%M:%S %Z',$count['last'])#</td>
        </tr>
        <tr>
          <td colspan="6">#$page#</td>
        </tr>
        </xar:foreach>
        <tr>
          <th>#$autocachetotal['ratio']#%</th>
          <th>#$autocachetotal['hit']#</th>
          <th>#$autocachetotal['miss']#</th>
          <th>#$autocachetotal['total']#</th>
          <th>#xarLocaleFormatDate('%a, %d %B %Y %H:%M:%S %Z',$autocachetotal['first'])#</th>
          <th>#xarLocaleFormatDate('%a, %d %B %Y %H:%M:%S %Z',$autocachetotal['last'])#</th>
        </tr>
        </table>

    </xar:if>
    </div>

</div>
