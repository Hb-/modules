<html>
<head>
<title>{$lang_theme_code_title}</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script language="javascript" src="../../tiny_mce_popup.js"></script>
<script language="javascript">
    function saveContent() {
        if (window.opener) {
            window.opener.tinyMCE.setContent(document.getElementById('htmlSource').value);
            window.close();
        }
    }

    // Fixes some charcode issues
    function fixContent(html) {
        html = tinyMCE.regexpReplace(html, '&amp;', '&amp;amp;', 'gi');
        html = tinyMCE.regexpReplace(html, '&nbsp;|&#160;', '&amp;nbsp;', 'gi');
        html = tinyMCE.regexpReplace(html, '&apos;', '&amp;apos;', 'gi');
        html = tinyMCE.regexpReplace(html, '&quot;', '&amp;quot;', 'gi');
        html = tinyMCE.regexpReplace(html, '&lt;', '&amp;lt;', 'gi');
        html = tinyMCE.regexpReplace(html, '&gt;', '&amp;gt;', 'gi');

        return html;
    }

    window.focus();
</script>
</head>
<body scroll="auto">

<div style="height: 90%">
    <div class="title">{$lang_theme_code_title}</div>
    <br>
    <script language="JavaScript">
        document.write('<textarea dir="ltr" id="htmlSource" name="htmlSource" style="width: 100%; height: 90%">' + fixContent(tinyMCE.getContent(tinyMCE.getWindowArg('editor_id'))) + '</textarea>');
    </script>
    <input type="button" id="insert" name="insert" value="{$lang_theme_code_save}" onclick="saveContent();">
</div>

</body>
</html>
